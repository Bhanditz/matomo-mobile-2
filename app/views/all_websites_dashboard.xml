<Alloy>
    <Collection src="piwikProcessedReport" id="piwikProcessedReport" instance="true"/>
    <Collection src="appAccounts"/>
    
    <Window id="index" onClose="onClose" onOpen="onOpen">
        <RightNavButton platform="ios,mobileweb">
            <Button id="accountsButton" onClick="chooseAccount"/>
        </RightNavButton>
        
        <Menu id="menu" platform="android">
            <MenuItem id="menuItemAccount" onClick="chooseAccount" />
        </Menu>

        <View id="loading"><Label id="loadingLabel"></Label></View>
        
        <View id="content" class="container">
            <SearchBar id="searchBar" onReturn="searchWebsite" onCancel="cancelSearchWebsite" platform="android,ios"/>
            <View class="searchBarContainer" platform="mobileweb">
                <View class="searchBarInnerContainer">
                    <TextField id="searchBar" onReturn="searchWebsite"/>
                </View>
            </View>
            <Require src="graph" id="reportGraphCtrl" formFactor="tablet"/>
            <View class="shadow" formFactor="tablet"></View>
            <TableView id="websitesTable" dataCollection="$.piwikProcessedReport" 
                       onClick="selectWebsite" dataTransform="formatWebsite">
                <HeaderPullView platform="ios">
                    <Require src="pull_to_refresh" id="pullToRefresh" onRefresh="doRefresh"/>
                </HeaderPullView>
                <HeaderView>
                    <View id="noWebsiteFoundContainer"><Label id="noWebsiteFoundLabel"/></View>
                </HeaderView>
                <FooterView>
                    <View id="useSearchHintContainer"><Label id="useSearchHintLabel"/></View>
                </FooterView>

                <TableViewRow modelid="{id}">
                    <Label class="websiteNameLabel" text="{label}" />

                    <View right="10" width="100" layout="vertical" height="SIZE">
                        <View class="space"></View>
                        <Label text="Visits" class="quickInfoName" />
                        <View right="0" layout="horizontal" height="SIZE">
                            <Label text="{nb_visits}" color="{evolution_color}" class="quickInfoValue"/>
                            <Label text=" (" color="{evolution_color}" class="quickInfoValue"/>
                            <Label text="{visits_evolution}" color="{evolution_color}" class="quickInfoValue"/>
                            <Label text=")" color="{evolution_color}" class="quickInfoValue"/>
                        </View>
                        <View class="space"></View>
                    </View>
                </TableViewRow>

            </TableView>
        </View>
    </Window>
</Alloy>